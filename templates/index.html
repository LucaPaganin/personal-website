<!DOCTYPE html>
<html lang="{{ g.locale }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {# Titolo dinamico basato sulla pagina #}
    <title>{% block title %}{{ g.cv_data.personal_info.name }}{% endblock %} - {{ _('Sito Personale') }}</title> {# Accesso a g.cv_data #}
    {# Tailwind CSS via CDN #}
    <script src="https://cdn.tailwindcss.com"></script>
    {# Configurazione Tailwind (opzionale, per personalizzazioni come il font Inter) #}
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    {# Font Inter da Google Fonts #}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    {# CSS Personalizzato (se necessario) #}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {# Favicon (opzionale) - <link rel="icon" href="{{ url_for('static', filename='img/favicon.ico') }}"> #}
</head>
<body class="bg-gray-100 font-sans text-gray-800">

    {# Header #}
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            {# Nome / Logo #}
            <div>
                <a href="{{ url_for('index') }}" class="text-xl font-semibold text-gray-700 hover:text-blue-600">{{ g.cv_data.personal_info.name }}</a> {# Accesso a g.cv_data #}
            </div>

            {# Navigazione Principale (Desktop) #}
            <div class="hidden md:flex items-center space-x-5">
                 {# Link di navigazione, usano _() di Babel per la traduzione #}
                <a href="{{ url_for('index') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'index' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Su di me') }}</a>
                <a href="{{ url_for('experience') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'experience' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Esperienza') }}</a>
                <a href="{{ url_for('education') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'education' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Formazione') }}</a>
                 <a href="{{ url_for('phd') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'phd' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Dottorato') }}</a>
                <a href="{{ url_for('skills') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'skills' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Competenze') }}</a>
                <a href="{{ url_for('projects') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'projects' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Progetti') }}</a>
                <a href="{{ url_for('publications') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'publications' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Pubblicazioni') }}</a>
                <a href="{{ url_for('conferences') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'conferences' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Conferenze') }}</a>
                <a href="{{ url_for('certifications') }}" class="px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-200 {% if request.endpoint == 'certifications' %}text-blue-600 font-semibold{% else %}text-gray-600{% endif %}">{{ _('Certificazioni') }}</a>

                {# Selettore Lingua #}
                <div class="flex space-x-2 items-center border-l pl-4 ml-4">
                   {% if g.locale == 'it' %}
                       <span class="text-sm font-semibold text-gray-700">IT</span>
                       <span class="text-gray-400">|</span>
                       <a href="{{ url_for('set_language', language='en') }}" class="text-sm text-gray-500 hover:text-blue-600">EN</a>
                   {% else %}
                       <a href="{{ url_for('set_language', language='it') }}" class="text-sm text-gray-500 hover:text-blue-600">IT</a>
                       <span class="text-gray-400">|</span>
                       <span class="text-sm font-semibold text-gray-700">EN</span>
                   {% endif %}
                   {# Alternativa con Bandiere (richiede immagini in static/img/)
                   <a href="{{ url_for('set_language', language='it') }}">
                       <img src="{{ url_for('static', filename='img/it_flag.png') }}" alt="{{ _('Italiano') }}" class="w-5 h-auto {% if g.locale == 'it' %}border-2 border-blue-500{% endif %}">
                   </a>
                   <a href="{{ url_for('set_language', language='en') }}">
                       <img src="{{ url_for('static', filename='img/en_flag.png') }}" alt="{{ _('Inglese') }}" class="w-5 h-auto {% if g.locale == 'en' %}border-2 border-blue-500{% endif %}">
                   </a>
                   #}
                </div>
            </div>

            {# Bottone Hamburger Menu (Mobile) #}
            <div class="md:hidden flex items-center">
                 {# Selettore Lingua Mobile #}
                <div class="flex space-x-1 items-center mr-4">
                   {% if g.locale == 'it' %}
                       <span class="text-xs font-semibold text-gray-700">IT</span>
                       <span class="text-gray-300 text-xs">|</span>
                       <a href="{{ url_for('set_language', language='en') }}" class="text-xs text-gray-500 hover:text-blue-600">EN</a>
                   {% else %}
                       <a href="{{ url_for('set_language', language='it') }}" class="text-xs text-gray-500 hover:text-blue-600">IT</a>
                       <span class="text-gray-300 text-xs">|</span>
                       <span class="text-xs font-semibold text-gray-700">EN</span>
                   {% endif %}
                </div>
                <button id="mobile-menu-button" class="outline-none mobile-menu-button">
                    <svg class=" w-6 h-6 text-gray-500 hover:text-blue-600 "
                        x-show="!showMenu"
                        fill="none"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                    >
                        <path d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </nav>

        {# Menu Mobile #}
        <div class="hidden mobile-menu md:hidden">
            <ul class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                 {# Link di navigazione mobile, usano _() di Babel #}
                <li><a href="{{ url_for('index') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'index' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Su di me') }}</a></li>
                <li><a href="{{ url_for('experience') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'experience' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Esperienza') }}</a></li>
                <li><a href="{{ url_for('education') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'education' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Formazione') }}</a></li>
                <li><a href="{{ url_for('phd') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'phd' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Dottorato') }}</a></li>
                <li><a href="{{ url_for('skills') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'skills' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Competenze') }}</a></li>
                <li><a href="{{ url_for('projects') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'projects' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Progetti') }}</a></li>
                <li><a href="{{ url_for('publications') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'publications' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Pubblicazioni') }}</a></li>
                <li><a href="{{ url_for('conferences') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'conferences' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Conferenze') }}</a></li>
                <li><a href="{{ url_for('certifications') }}" class="block px-3 py-2 rounded-md text-base font-medium hover:bg-gray-200 {% if request.endpoint == 'certifications' %}text-blue-600 font-semibold{% else %}text-gray-700{% endif %}">{{ _('Certificazioni') }}</a></li>
            </ul>
        </div>
    </header>

    {# Contenuto Principale #}
    <main class="container mx-auto px-6 py-8">
        {% block content %}
        {# Il contenuto specifico della pagina verrà inserito qui #}
        {% endblock %}
    </main>

    {# Footer #}
    <footer class="bg-gray-800 text-white mt-12">
        <div class="container mx-auto px-6 py-4 text-center text-sm">
             {# Copyright: Anno corrente + Nome da JSON + Stringa UI tradotta da Babel #}
            <p>&copy; {{ now().year }} {{ g.cv_data.personal_info.name }}. {{ _('Tutti i diritti riservati.') }}</p>
            {# Link nel footer #}
            <div class="mt-2">
                <a href="mailto:{{ g.cv_data.personal_info.email }}" class="hover:text-blue-400">{{ g.cv_data.personal_info.email }}</a>
                {% if g.cv_data.personal_info.linkedin_url and g.cv_data.personal_info.linkedin_url != '#' %}
                <span class="mx-2">|</span>
                <a href="{{ g.cv_data.personal_info.linkedin_url }}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400">LinkedIn</a>
                {% endif %}
                 {% if g.cv_data.personal_info.github_url and g.cv_data.personal_info.github_url != '#' %}
                <span class="mx-2">|</span>
                <a href="{{ g.cv_data.personal_info.github_url }}" target="_blank" rel="noopener noreferrer" class="hover:text-blue-400">GitHub</a>
                 {% endif %}
            </div>
        </div>
    </footer>

    {# Script per Hamburger Menu #}
    <script>
        const btn = document.getElementById('mobile-menu-button');
        const menu = document.querySelector('.mobile-menu');

        btn.addEventListener('click', () => {
            menu.classList.toggle('hidden');
        });
    </script>

</body>
</html>
